
node('main') {
    stage('Git checkout'){
     git branch: 'dev', credentialsId: 'github-ssh-key', url: 'git@github.com:islommuhammad/Exadel-Tasks.git'
    }
    stage('Build Docker Image'){
      sh 'docker build -t islommamatov/apache:latest Task6'
    }
    stage('Run Docker Image'){
      withCredentials([string(credentialsId: 'dockerhub-password', variable: 'Pwd')]) {
          sh "docker run --env PASSWORD= ${Pwd} --name myApache islommamatov/apache:latest"
        }
    }
}